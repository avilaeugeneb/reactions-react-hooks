(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e){e.exports={publishKey:"pub-c-cb3f4a04-12cb-4568-8b50-229d75c37bc9",subscribeKey:"sub-c-3e749d0e-5b7e-11e9-af7f-e675e2b0822b",secretKey:"sub-c-3e749d0e-5b7e-11e9-af7f-e675e2b0822b"}},12:function(e,t,n){e.exports=n(22)},18:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),u=n(8),c=n.n(u),s=(n(18),n(4)),i=n(3),l=n(6),m=n(2),o=[{type:"REACTION_LOVE",emoji:"\u2764\ufe0f"},{type:"REACTION_LIKE",emoji:"\ud83d\udc4d"},{type:"REACTION_DISLIKE",emoji:"\ud83d\udc4e"},{type:"REACTION_LAUGH",emoji:"\ud83d\ude02"}],b={messages:[],username:"anonymous",reactionsMap:{}},p=o.map(function(e){return e.type}),E=function(e,t){if(p.includes(t.type)){var n=t.item.messageId,a=e.reactionsMap[n],r=Object(m.a)({},e.reactionsMap,Object(i.a)({},n,a?[].concat(Object(l.a)(a),[t.item]):[t.item]));return Object(m.a)({},e,{reactionsMap:r})}switch(t.type){case"NEW_MESSAGE":return Object(m.a)({},e,{messages:[].concat(Object(l.a)(e.messages),[t.item])});case"SET_USERNAME":return Object(m.a)({},e,{username:t.username});default:return e}},f=n(9),d=n(10),v=n.n(d),h=n(11),g=n(5),j=n.n(g),y=n(1),O=n.n(y),S=function(e){return{type:"SET_USERNAME",username:e}},A=function(e){var t=e.type,n=e.emoji,a=e.username,r=e.messageId;return{type:t,item:{id:j()(),timestamp:O()().valueOf(),emoji:n,username:a,messageId:r}}},I=Object(a.createContext)(),C=function(){return Object(a.useContext)(I)},N=function(){var e=C(),t=e.pubsub.publish,n=e.state.username,u=Object(a.useState)(""),c=Object(s.a)(u,2),i=c[0],l=c[1],m=function(){i.trim()&&t(function(e){var t=e.text,n=e.username;return{type:"NEW_MESSAGE",item:{id:j()(),text:t,timestamp:O()().valueOf(),username:n}}}({text:i,username:n}))};return r.a.createElement("div",null,r.a.createElement("h3",null,"Got something to say?"),r.a.createElement("input",{value:i,onChange:function(e){l(e.target.value)},onKeyPress:function(e){return function(e){var t=e.event,n=e.action,a=e.proceed,r=void 0===a||a;"Enter"===t.key&&r&&n()}({event:e,proceed:i.trim(),action:m})}})," ",r.a.createElement("button",{onClick:m},"Publish it!"))};var L=function(e){var t=e.messageId,n=C(),a=n.state.username,u=n.pubsub.publish;return r.a.createElement("div",{className:"CreateReaction"},o.map(function(e){var n=e.type,c=e.emoji;return r.a.createElement("span",{key:n,onClick:function(){return function(e){var n=e.type,r=e.emoji;u(A({type:n,emoji:r,username:a,messageId:t}))}({type:n,emoji:c})}},c)}))};var R=function(e){var t=e.messageReactions;return t?t.map(function(e,n){var a=e.id,u=e.emoji,c=e.username;return r.a.createElement("span",{key:a},r.a.createElement("em",null,c,":"),u,n!==t.length-1?", ":null)}):null};function M(){var e=C().state,t=e.messages,n=e.reactionsMap;return r.a.createElement("div",null,t.map(function(e){var t=e.id,a=e.text,u=e.timestamp,c=e.username;return r.a.createElement("div",{key:t},r.a.createElement("h4",null,O()(u).format("LLL")),r.a.createElement("p",null,a),r.a.createElement("h4",null,"- ",c),r.a.createElement(L,{messageId:t}),r.a.createElement(R,{messageReactions:n[t]}),r.a.createElement("hr",null))}))}var _=function(){var e=C(),t=e.state.username,n=e.dispatch;return r.a.createElement("div",null,r.a.createElement("h3",null,"Username"),r.a.createElement("input",{onChange:function(e){n(S(e.target.value))},value:t}))},w=new function e(t){var n=this;Object(f.a)(this,e),this.addListener=function(e){return n.pubnub.addListener(e)},this.publish=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"MESSAGE_CHANNEL";return n.pubnub.publish({message:e,channel:t})},this.subscribe=function(e){n.pubnub.subscribe({channels:e})},this.pubnub=new v.a(h),this.subscribe(t)}(["MESSAGE_CHANNEL"]),k=function(){var e=Object(a.useReducer)(E,b),t=Object(s.a)(e,2),n=t[0],u=t[1];return console.log("STATE",n),Object(a.useEffect)(function(){w.addListener({message:function(e){var t=e.channel,n=e.message;console.log("Received a message",n),console.log("from channel:",t),u(n)}})},[]),r.a.createElement(I.Provider,{value:{state:n,dispatch:u,pubsub:w}},r.a.createElement("h2",null,"Reaction"),r.a.createElement(_,null),r.a.createElement("hr",null),r.a.createElement(N,null),r.a.createElement("hr",null),r.a.createElement(M,null))};c.a.render(r.a.createElement(k,null),document.getElementById("root"))}},[[12,1,2]]]);
//# sourceMappingURL=main.1ce293e0.chunk.js.map